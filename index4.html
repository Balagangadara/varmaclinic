<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <link href="floatingicon.css" rel="stylesheet"> 
    <link href="index.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
     <script type="text/javascript" src="time.js" ></script>
      
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>Varma Clinic</title>
   

</head>
<body>
    
    <div class="form-container">
        <a href="index1.html" class="next-button" style="background-color:  rgb(2, 7, 55); color: whitesmoke;">Next</a>
        <img src="images/logo.png" width="620" height="100" alt="Form Logo" />
        <h1>Book Your Appointment</h1>
        <form id="appointmentForm">
            <div class="form-group">
                <label for="name">Patient Name:</label>
                <input type="text" id="name" name="name" required placeholder="Enter name" oninput="validateForm()">
                <small id="nameError" class="error-message">Please enter a valid name (alphabets only).</small>
            </div>
            <div class="form-group">
                <label for="age">Age:</label>
                <input type="number" id="age" name="age" required placeholder="Enter age" oninput="validateForm()">
                <small id="ageError" class="error-message">Please enter a valid age (1-110 and up to 3 digits).</small>
            </div>
            <div class="form-group">
                <label for="gender" style="margin-top: 20px;">Gender:</label>
                <select id="gender" name="gender" required onchange="validateForm()">
                    <option value="">Please Select</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="Transgender">Transgender</option>
                </select>
            </div>
            <div class="form-group" style="margin-top: 20px;">
                <label for="phone" style="margin-top: 20px;">Mobile Number:</label>
                <input type="text" class="form-control" name="Mobile number" id="phone" placeholder=""
                       maxlength="10" required>
                <small id="phoneError" class="error-message" style="display:none; color: red;">
                    Phone number must be 10 digits long and start with a digit between 6-9.
                </small>
            </div>
            
            
            <div class="form-group">
                <label style="margin-top: 20px; padding-bottom: 15px;">Reason For Your Appointment:</label>
                <div class="reason-container">
                    <!-- Existing checkbox items -->
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" name="reason" value="Fever" onchange="validateForm()"> Fever
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" name="reason" value="Cold/Cough" onchange="validateForm()"> Cold/Cough
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" name="reason" value="Vomiting" onchange="validateForm()"> Vomiting
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" name="reason" value="Head Ache" onchange="validateForm()"> Head Ache
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" name="reason" value="Diarrhoea/Dysentery" onchange="validateForm()"> Diarrhoea/Dysentery
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" name="reason" value="Stomach Pain" onchange="validateForm()"> Stomach Pain
                        </label>
                    </div>
                    <div class="checkbox-item">
                        <label>
                            <input type="checkbox" name="reason" value="Body pain/Joint pain" onchange="validateForm()"> Body pain/Joint pain
                        </label>
                    </div>
                    <div class="checkbox-item others-input-container">
                        <label>
                            <input type="checkbox" name="reason" value="Others" onchange="toggleOthersInput()"> Others
                        </label>
                        <input type="text" id="othersInput" maxlength="20" oninput="validateOthersInput()" style="display:none;" placeholder="Type here...">
                    </div>
                </div> 
            </div>
            
        
            <div class="form-group">
                <label for="date">Select Date:</label>
                <input type="date" id="date" onchange="loadSlots()">
                <div id="available-slots">
                    <!-- Available slots will be dynamically loaded here -->
                </div>
            </div>
            <!-- <div class="form-group">
                <label for="paymentQR" style="margin-top: 20px;margin-left: 54px;">Scan Me To Complete Your Payment</label>
                <img src="images/webQR.jpg" alt="Payment QR Code" id="paymentQR" style="width: 150px; height: 150px; margin-top: 10px;">
            </div> -->
         
            <div class="appointment-container">
                <div class="appointment-heading">Book your appointment via</div>
                <div class="appointment-buttons">
                    <button type="button" id="whatsappButton" onclick="redirectToWhatsApp()" disabled>
                        <i class="fab fa-whatsapp" style="color: #25D366;"></i> <!-- WhatsApp Green -->
                    </button>
                    <button type="button" id="smsButton" onclick="redirectToSMS()" disabled>
                        <i class="fas fa-sms" style="color: #007BFF;"></i> <!-- SMS Blue -->
                    </button>
                    <button type="button" id="emailButton" onclick="redirectToEmail()" disabled>
                        <i class="fas fa-envelope" style="color: #FF5722;"></i> <!-- Email Orange -->
                    </button>
                    <button type="button" id="callButton" onclick="redirectToCall()" enabled>
                        <i class="fas fa-phone" style="color: #4CAF50;"></i> <!-- Phone Green -->
                    </button>
                </div>
                 <div class="form-group">
                    <label for="paymentQR" style="margin-top: 20px;">Scan Me To Complete Your Payment</label>
                    <img src="images/webQR.jpg" alt="Payment QR Code" id="paymentQR" style="width: 150px; height: 150px; margin-top: 10px;">
                </div> 
            </div>
            </form>
<!-- <div class="container">
    <div class="floating-contact right">
        <a href="https://wa.me/9094852653" target="_blank">
            <img src="images/whats.png" alt="WhatsApp Icon">
        </a>
        <a href="mailto:balavarmaclinic@gmail.com?subject=Appointment%20Request" target="_blank">
            <img src="images/mail.png" alt="Email Icon">
        </a>
        <a href="sms:9094852653?body=Hello%20there!" target="_blank">
            <img src="images/message.png" alt="Message Icon">
        </a>
        <a href="tel:9094852653" target="_blank">
            <img src="images/call.png" alt="Call Icon">
        </a>
    </div>
</div> -->

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            async function fetchBlockedDates() {
                try {
                    const response = await fetch('https://raw.githubusercontent.com/Balagangadara/calender/main/unavailable-dates.json');
                    if (!response.ok) {
                        throw new Error('Network response was not ok.');
                    }
                    const data = await response.json();
                    return data.dates; // Ensure this matches the JSON structure
                } catch (error) {
                    console.error('Error fetching blocked dates:', error);
                    return [];
                }
            }

            function formatDate(date) {
                return date.toISOString().split('T')[0];
            }

            async function initializeDatePicker() {
                const blockedDates = await fetchBlockedDates();
                const today = new Date();
                const nextSevenDays = new Date(today);
                nextSevenDays.setDate(today.getDate() + 7);

                const datePicker = flatpickr("#appointment_date", {
                    dateFormat: "Y-m-d",
                    minDate: formatDate(today),
                    maxDate: formatDate(nextSevenDays),
                    disable: blockedDates,
                    onChange: function(selectedDates) {
                        validateForm();
                    },
                });

                document.getElementById('calendar-icon').addEventListener('click', () => {
                    datePicker.open();
                });
            }

            initializeDatePicker();
        });
        function validatePhoneNumber() {
    const phoneInput = document.getElementById("phone");
    const phoneError = document.getElementById("phoneError");

    // Get the input value and remove all non-numeric characters
    let phoneValue = phoneInput.value;
    phoneValue = phoneValue.replace(/\D/g, ''); // Keep only digits

    // Validate the cleaned value
    const phonePattern = /^[6-9][0-9]{9}$/;

    if (phonePattern.test(phoneValue)) {
        phoneInput.value = phoneValue; // Update input value to cleaned value
        phoneError.style.display = "none"; // Hide error message if valid
    } else {
        phoneError.style.display = "block"; // Show error message if invalid
        phoneError.textContent = "Phone number must be 10 digits long and start with a digit between 6-9.";
    }
}

// Add event listener for real-time validation
document.getElementById("phone").addEventListener("input", function() {
    // Enforce numeric input only
    this.value = this.value.replace(/\D/g, '');
    validatePhoneNumber();
});

       
        function restrictAgeInput() {
            const ageInput = document.getElementById("age");
            const ageError = document.getElementById("ageError");
            let value = ageInput.value;

            value = value.replace(/\D/g, '');

            const age = parseInt(value, 10);

            if (value.length > 3 || age < 1 || age > 110) {
                ageError.style.display = "block";
                ageInput.value = '';
            } else {
                ageError.style.display = "none";
                ageInput.value = value;
            }
        }

        function restrictNameInput() {
    const nameInput = document.getElementById("name");
    const nameError = document.getElementById("nameError");
    let value = nameInput.value;

    // Remove any non-letter characters and extra spaces
    value = value.replace(/[^a-zA-Z\s]/g, '');
    nameInput.value = value;

    // Check the length of the cleaned value
    const letterOnlyValue = value.replace(/\s/g, ''); // Remove spaces for length check
    if (letterOnlyValue.length < 3) {
        nameError.style.display = "block";
        nameError.textContent = "Name must be at least 3 letters.";
    } else {
        nameError.style.display = "none";
    }
}


        function validateForm() {
            const name = document.getElementById("name").value.trim();
            const age = document.getElementById("age").value.trim();
            const gender = document.getElementById("gender").value;
            const phone = document.getElementById("phone").value.trim();
            const reason = document.getElementById("reason").value;
            const appointmentDate = document.getElementById("appointment_date").value;
            const timeSlot = document.getElementById("time_slot").value;

            const nameValid = name !== "" && /^[a-zA-Z\s]+$/.test(name);
            const ageValid = age !== "" && /^[1-9][0-9]?$|^1[0-1][0-9]$/.test(age);
            const phoneValid = /^[6-9][0-9]{9}$/.test(phone);
            const genderValid = gender !== "";
            const reasonValid = reason !== "";
            const appointmentDateValid = appointmentDate !== "";
            const timeSlotValid = timeSlot !== "";

            const allValid = nameValid && ageValid && phoneValid && genderValid && reasonValid && appointmentDateValid && timeSlotValid;

            document.getElementById("whatsappButton").disabled = !allValid;
            document.getElementById("smsButton").disabled = !allValid;
            document.getElementById("emailButton").disabled = !allValid;
            document.getElementById("callButton").disabled = !allValid;
            document.getElementById("formspreeButton").disabled = !allValid;
        }

        document.getElementById("name").addEventListener("input", function() {
            restrictNameInput();
            validateForm();
        });

        document.getElementById("age").addEventListener("input", function() {
            restrictAgeInput();
            validateForm();
        });

        document.getElementById("phone").addEventListener("input", function() {
            validatePhoneNumber();
            validateForm();
        });

        document.getElementById("gender").addEventListener("change", validateForm);
        document.getElementById("reason").addEventListener("change", validateForm);
        document.getElementById("appointment_date").addEventListener("change", validateForm);
        document.getElementById("time_slot").addEventListener("change", validateForm);


        function validateOthersInput() {
    const othersInput = document.getElementById('othersInput');
    const value = othersInput.value;

    // Remove all non-letter and non-space characters
    const sanitizedValue = value.replace(/[^a-zA-Z\s]/g, '');
    
    // Limit the length to 20 characters
    if (sanitizedValue.length > 20) {
        othersInput.value = sanitizedValue.substring(0, 20);
    } else {
        othersInput.value = sanitizedValue;
    }
}


    </script>

       <style>   .form-container {
        width: 80%; /* Adjust this percentage as needed */
        max-width: 400px; /* You can set a maximum width if desired */
        margin: 0 auto; /* Centers the container */
        padding: 20px; /* Optional: Adds padding inside the container */
    }
    @media (max-width: 768px) {
        .form-container {
            width: 90%; /* Adjust the width for smaller screens */
            padding: 15px; /* Adjust padding for smaller screens */
        }
    }
</style>
 
    
    
</body>
</html>
